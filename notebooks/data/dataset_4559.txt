Micro Mass Seed Four Rows Two Thousand N Classes Ten N Cols One Hundred Stratify True

Tags: Machine Learning, Mathematics

Sub sampling of the dataset Micro Mass with seed equals four arguments number rows max equals two thousand arguments number columns max equals one hundred arguments number classes max equals ten arguments no stratify equals true generated with the following source code:

def sub sample self seed number rows max number cols max number classes max stratified boolean true 
    -> Dataset:
random number generator equals numpy dot random dot default random generator seed
x equals self x 
y equals self y 

uniformly sample classes equals y unique 
if length of classes greater than number classes max 
    value counts equals y value counts 
    selected classes equals random number generator choice classes size number classes max replace false probability value counts over sum value counts 

select the indices where one of these classes is present index equals y index y is in selected classes 
x equals x iloc index 
y equals y iloc index 

uniformly sample columns if required 
if length of x columns greater than number cols max 
    column indexes equals random number generator choice list range length x columns size number cols max replace false 
    sorted column indexes equals sorted column indexes 
    selected columns equals list x columns sorted column indexes 
x equals x selected columns 
else 
    sorted column indexes equals list range length x columns 

if length of x greater than number rows max 
    stratify accordingly target name equals y name 
    data equals pandas concat x y axis columns 
    underscore subset equals train test split data test size number rows max stratify data target name shuffle true random state seed 
x equals subset drop target name axis columns 
y equals subset target name 

we need to convert categorical columns to string for open ml 
categorical mask equals list self categorical mask i for i in sorted column indexes 
columns equals list x columns 
return Dataset 
dataset equals self dataset 
x equals x 
y equals y 
categorical mask equals categorical mask 
columns equals columns 

Features: ...skipped...

Keywords: machine learning, mathematics, sub sampling, dataset, stratification, feature selection